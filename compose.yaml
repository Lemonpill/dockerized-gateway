services:
  gateway:
    build: ./gateway
    environment:
      PYTHONDONTWRITEBYTECODE: 1
      SERVER_HOST: 0.0.0.0
      SERVER_PORT: 5000
      CONFIG_FILE: config.yaml
      LOG_FILE: gateway.log
      LOG_FORMAT: "%(asctime)s -- [%(funcName)s] %(message)s"
      LOG_LEVEL: DEBUG
    volumes:
      - ./gateway:/app/
    command: python main.py
    ports:
      - 8000:5000
    depends_on:
      - profiles

  profiles:
    build: ./profiles
    environment:
      PYTHONDONTWRITEBYTECODE: 1
      LOG_FILE: profiles.log
      LOG_FORMAT: "%(asctime)s -- [%(funcName)s] %(message)s"
      LOG_LEVEL: DEBUG
    volumes:
      - ./profiles:/app/
    command: uvicorn main:app --host 0.0.0.0 --port 5000

volumes:
  gateway:
  profiles: